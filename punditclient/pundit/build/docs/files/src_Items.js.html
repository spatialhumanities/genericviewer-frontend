<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src&#x2F;Items.js - Pundit</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.8.0pr2&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.8.0pr2&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="http:&#x2F;&#x2F;thepund.it&#x2F;assets&#x2F;img&#x2F;pundit_500.png" title="Pundit"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: PUNDIT Project 0.12-Pumpkin</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/pundit.annotators.AnnotatorsBase.html">pundit.annotators.AnnotatorsBase</a></li>
            
                <li><a href="..&#x2F;classes/pundit.annotators.AnnotatorsConductor.html">pundit.annotators.AnnotatorsConductor</a></li>
            
                <li><a href="..&#x2F;classes/pundit.annotators.FakeAnnotator.html">pundit.annotators.FakeAnnotator</a></li>
            
                <li><a href="..&#x2F;classes/pundit.annotators.TextFragmentAnnotator.html">pundit.annotators.TextFragmentAnnotator</a></li>
            
                <li><a href="..&#x2F;classes/pundit.authenticatedRequests.html">pundit.authenticatedRequests</a></li>
            
                <li><a href="..&#x2F;classes/pundit.baseComponent.html">pundit.baseComponent</a></li>
            
                <li><a href="..&#x2F;classes/pundit.BasePanel.html">pundit.BasePanel</a></li>
            
                <li><a href="..&#x2F;classes/pundit.CommentTag.html">pundit.CommentTag</a></li>
            
                <li><a href="..&#x2F;classes/pundit.CommentTagPanel.html">pundit.CommentTagPanel</a></li>
            
                <li><a href="..&#x2F;classes/pundit.Configuration.html">pundit.Configuration</a></li>
            
                <li><a href="..&#x2F;classes/pundit.contextualMenu.html">pundit.contextualMenu</a></li>
            
                <li><a href="..&#x2F;classes/pundit.DataTxt.html">pundit.DataTxt</a></li>
            
                <li><a href="..&#x2F;classes/pundit.DbpediaSpotlight.html">pundit.DbpediaSpotlight</a></li>
            
                <li><a href="..&#x2F;classes/pundit.FastTextHandler.html">pundit.FastTextHandler</a></li>
            
                <li><a href="..&#x2F;classes/pundit.ImageAnnotationPanel.html">pundit.ImageAnnotationPanel</a></li>
            
                <li><a href="..&#x2F;classes/pundit.Init.html">pundit.Init</a></li>
            
                <li><a href="..&#x2F;classes/pundit.ItemContainerManager.html">pundit.ItemContainerManager</a></li>
            
                <li><a href="..&#x2F;classes/pundit.KorboBasketSelector.html">pundit.KorboBasketSelector</a></li>
            
                <li><a href="..&#x2F;classes/pundit.myPundit.html">pundit.myPundit</a></li>
            
                <li><a href="..&#x2F;classes/pundit.NotebookManager.html">pundit.NotebookManager</a></li>
            
                <li><a href="..&#x2F;classes/pundit.PageHandler.html">pundit.PageHandler</a></li>
            
                <li><a href="..&#x2F;classes/pundit.Previewer.html">pundit.Previewer</a></li>
            
                <li><a href="..&#x2F;classes/pundit.RecognizerPanel.html">pundit.RecognizerPanel</a></li>
            
                <li><a href="..&#x2F;classes/pundit.ResourcesPanel.html">pundit.ResourcesPanel</a></li>
            
                <li><a href="..&#x2F;classes/pundit.selectors.BibServerSelector.html">pundit.selectors.BibServerSelector</a></li>
            
                <li><a href="..&#x2F;classes/pundit.selectors.DBPediaSelector.html">pundit.selectors.DBPediaSelector</a></li>
            
                <li><a href="..&#x2F;classes/pundit.selectors.EuropeanaSelector.html">pundit.selectors.EuropeanaSelector</a></li>
            
                <li><a href="..&#x2F;classes/pundit.selectors.FreebaseSelector.html">pundit.selectors.FreebaseSelector</a></li>
            
                <li><a href="..&#x2F;classes/pundit.selectors.SelectorBase.html">pundit.selectors.SelectorBase</a></li>
            
                <li><a href="..&#x2F;classes/pundit.selectors.VocabSelector.html">pundit.selectors.VocabSelector</a></li>
            
                <li><a href="..&#x2F;classes/pundit.selectors.WordnetSelector.html">pundit.selectors.WordnetSelector</a></li>
            
                <li><a href="..&#x2F;classes/pundit.TripleComposer.html">pundit.TripleComposer</a></li>
            
                <li><a href="..&#x2F;classes/pundit.XpointersHelper.html">pundit.XpointersHelper</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/pundit.html">pundit</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src&#x2F;Items.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
dojo.provide(&quot;pundit.Items&quot;);
dojo.declare(&quot;pundit.Items&quot;, pundit.BaseComponent, {

    constructor: function(options) {},
    init: function(name) {
        var self = this;
        self.crypto = new pundit.Crypto();        
        this.name = name;
        var si = &#x27;&lt;div id=&quot;pundit-&#x27; + this.name + &#x27;-container&quot; class=&quot;pundit-tab pundit-selected&quot;&gt;&#x27;;

        si += &#x27;&lt;div class=&quot;pundit-tab-header&quot;&gt;&lt;ul id=&quot;pundit-&#x27; + this.name + &#x27;-filter-list&quot; class=&quot;pundit-item-filter-list&quot;&gt;&#x27;;
        &#x2F;&#x2F;si += &#x27;&lt;li id=&quot;filter&#x27; + this.name + &#x27;All&quot;&gt;All&lt;&#x2F;li&gt;&#x27;;
        si += &#x27;&lt;li id=&quot;pundit-tab-filter-&#x27; + this.name + &#x27;-fragment&quot; class=&quot;pundit-selected&quot;&gt;Text-fragment&lt;&#x2F;li&gt;&#x27;;
        si += &#x27;&lt;li id=&quot;pundit-tab-filter-&#x27; + this.name + &#x27;-images&quot;&gt;Images&lt;&#x2F;li&gt;&#x27;;
        si += &#x27;&lt;li id=&quot;pundit-tab-filter-&#x27; + this.name + &#x27;-images-fragment&quot;&gt;Image Fragments&lt;&#x2F;li&gt;&#x27;;
        si += &#x27;&lt;li id=&quot;pundit-tab-filter-&#x27; + this.name + &#x27;-entities&quot;&gt;Terms&lt;&#x2F;li&gt;&#x27;;
        si += &#x27;&lt;li id=&quot;pundit-tab-filter-&#x27; + this.name + &#x27;-pages&quot;&gt;Pages&lt;&#x2F;li&gt;&#x27;;
        &#x2F;&#x2F;si += &#x27;&lt;li id=&quot;filter&#x27; + this.name + &#x27;Relations&quot;&gt;Relations&lt;&#x2F;li&gt;&#x27;;
        &#x2F;&#x2F;si += &#x27;&lt;li id=&quot;filter&#x27; + this.name + &#x27;Literals&quot;&gt;Literals&lt;&#x2F;li&gt;&#x27;;
        &#x2F;&#x2F;si += &#x27;&lt;li id=&quot;filter&#x27; + this.name + &#x27;Favorites&quot;&gt;Favorites&lt;&#x2F;li&gt;&#x27;;
        &#x2F;&#x2F;si += &#x27;&lt;li id=&quot;filter&#x27; + this.name + &#x27;Recent&quot;&gt;Recent&lt;&#x2F;li&gt;&#x27;;

        &#x2F;&#x2F;DEBUG Do we still need Suggestions here?

        si += &#x27;&lt;li id=&quot;pundit-tab-filter-&#x27; + this.name + &#x27;-suggestions&quot; class=&quot;pundit-hidden&quot;&gt;&lt;span class=&quot;suggestionNumber&quot;&gt;&lt;&#x2F;span&gt; Suggestions&lt;&#x2F;li&gt;&#x27;;
        si += &#x27;&lt;&#x2F;ul&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;pundit-sort-items pundit-view-tile &quot;&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;pundit-sort-items pundit-view-list pundit-selected&quot;&gt;&lt;&#x2F;div&gt;&#x27;;

        si += &#x27;&lt;div id=&quot;pundit-tab-content&#x27; + this.name + &#x27;&quot; class=&quot;pundit-tab-content pundit-stop-wheel-propagation&quot;&gt;&lt;ul id=&quot;pundit-&#x27;+this.name +&#x27;&quot; class=&quot;pundit-items pundit-view-list&quot;&gt;&lt;&#x2F;ul&gt;&lt;&#x2F;div&gt;&#x27;;

        si += &#x27;&lt;&#x2F;div&gt;&#x27;;
        dojo.query(&#x27;#pundit-gui-center&#x27;).append(si);

        self.initDnD();
        self.initBehaviors();
        
        &#x2F;&#x2F;Register callback used currently by literal selector
        self.createCallback([&#x27;itemAdded&#x27;, &#x27;itemRemoved&#x27;, &#x27;allItemsRemoved&#x27;]);
        
        self.log(&quot;Pundit&quot; + self.name + &quot;Container up and running..&quot;);
        
        _PUNDIT.init.onInitDone(function(){
            setTimeout(function(){
                self.showOnlyItems(self.getNodesWhereTypeIs(ns.fragments.text));
                &#x2F;&#x2F;TODO REMOVE THIS SHIT!
                &#x2F;&#x2F;
                &#x2F;&#x2F;This should be configuable or in any case not fired twice as now
                dojo.query(&#x27;#pundit-tab-filter-&#x27;+ self.name +&#x27;-fragment&#x27;).addClass(&#x27;pundit-selected&#x27;);
&#x2F;&#x2F;                dojo.query(&#x27;#semlibMyItemsContainer&#x27;).addClass(&#x27;pundit-selected&#x27;);
&#x2F;&#x2F;                dojo.query(&#x27;#semlibItemsContainer&#x27;).removeClass(&#x27;pundit-selected&#x27;);
            }, 1000);
        });
        
    }, &#x2F;&#x2F; constructor()

    initDnD: function() {
        var self = this;

        &#x2F;&#x2F; punditItems source does not accept any item; 
        &#x2F;&#x2F; dnd drag actions copy items from it
        self.itemsDnD = new dojo.dnd.Source(&quot;pundit-&quot;+ self.name, {
            copyOnly: true, 
            creator: self.itemNodeCreator,
            checkAcceptance: function() {return false;}
        });
    },

    initBehaviors: function() {
        var self = this;

        var tabs = {},
            beh = {};
        tabs[&#x27;#pundit-tab-filter-&#x27; + this.name + &#x27;-entities&#x27;] = function() {return self.getNodesEntities()};
        tabs[&#x27;#pundit-tab-filter-&#x27; + this.name + &#x27;-fragment&#x27;] = function() {return self.getNodesWhereTypeIs(ns.fragments.text)};
        tabs[&#x27;#pundit-tab-filter-&#x27; + this.name + &#x27;-images&#x27;] = function() {return self.getNodesWhereTypeIs(ns.image)};
        tabs[&#x27;#pundit-tab-filter-&#x27; + this.name + &#x27;-images-fragment&#x27;] = function() {return self.getNodesWhereTypeIs(ns.fragments.image)};
        tabs[&#x27;#pundit-tab-filter-&#x27; + this.name + &#x27;-pages&#x27;] = function() {return self.getNodesWhereTypeIs(ns.page)};
        
            
        &#x2F;&#x2F; DEBUG: provide a way for other components to add filters
        
        for (var t in tabs) {
            var f = (function(id, provider) {
                return function() {
                    self.showOnlyItems(provider());
                    self.hideSuggestionsTab();
                    dojo.query(&#x27;#pundit-&#x27; + self.name + &#x27;-container .pundit-item-filter-list li&#x27;).removeClass(&#x27;pundit-selected&#x27;);
                    dojo.query(id).addClass(&#x27;pundit-selected&#x27;);
                }
            })(t, tabs[t]);
            self[&#x27;show_&#x27;+t.substr(1).replace(&#x2F;-&#x2F;g, &#x27;&#x27;)] = f;
            dojo.connect(dojo.query(t)[0], &#x27;onclick&#x27;, f);
        }
        
        &#x2F;&#x2F;DEBUG Use low level behavior 
        beh[&#x27;#pundit-&#x27; + self.name + &#x27; li.dojoDndItem span.pundit-icon-context-button&#x27;] = {
            &#x27;onclick&#x27;: function (e) {
                    var id = dojo.query(e.target).parent()[0].id;
                    var item = self.itemsDnD.getItem(id);
                    if (item.data.rdftype.length === 0){
                        cMenu.show(e.pageX - window.pageXOffset, e.pageY - window.pageYOffset, item.data, &#x27;semlibLiteral&#x27;+self.name);
                    }else{
                        &#x2F;&#x2F;cMenu.show(e.pageX - window.pageXOffset, e.pageY - window.pageYOffset, item.data.value, &#x27;semlib&#x27;+self.name);
                        cMenu.show(e.pageX - window.pageXOffset, e.pageY - window.pageYOffset, item.data, &#x27;pundit-&#x27;+self.name);
                    }
                }
        };
    
        beh[&#x27;#pundit-&#x27;+self.name+&#x27; li.dojoDndItem&#x27;] = {
            &#x27;onmouseover&#x27;:function (e) {
                    var id = (dojo.hasClass(e.target, &#x27;pundit-icon-context-button&#x27;)||dojo.hasClass(e.target, &#x27;pundit-trim&#x27;)) ? dojo.query(e.target).parent()[0].id : e.target.id;
                    var item = self.itemsDnD.getItem(id);
                    
                    &#x2F;&#x2F;previewer.selectAndPreviewItemWithId(id, item.data.value);
                    previewer.show(item.data.value);
                                                                
                    if (tooltip_viewer.isAnnXpointer(item.data.value) || tooltip_viewer.isTempXpointer(item.data.value))
                        tooltip_viewer.highlightByXpointer(item.data.value);
                },
            &#x27;onmouseout&#x27;:function (e) {
                var id = (dojo.hasClass(e.target, &#x27;pundit-icon-context-button&#x27;)||dojo.hasClass(e.target, &#x27;pundit-trim&#x27;)) ? dojo.query(e.target).parent()[0].id : e.target.id;
                var item = self.itemsDnD.getItem(id);
                if (tooltip_viewer.isAnnXpointer(item.data.value) || tooltip_viewer.isTempXpointer(item.data.value))
                    tooltip_viewer.removeHighlightByXpointer(item.data.value);                
                },
            &#x27;onclick&#x27;: function (e) {
                    var target = e.target;
                    while (!dojo.hasClass(dojo.query(target)[0], &#x27;dojoDndItem&#x27;))
                        target = dojo.query(target).parent()[0];
                    var id = target.id;
                    self.itemsDnD.selectNone();
                    self.itemsDnD.selection[id] = 1;
                }
        };
    
            
        &#x2F;&#x2F; Items layout
        beh[&#x27;#pundit-&#x27; +self.name +&#x27;-container .pundit-sort-items.pundit-view-list&#x27;]= {
            &#x27;onclick&#x27;: function(e) {
                self.setItemsLayout(&#x27;pundit-view-list&#x27;);
            }
        };
        beh[&#x27;#pundit-&#x27; +self.name +&#x27;-container .pundit-sort-items.pundit-view-tile&#x27;]= {
            &#x27;onclick&#x27;: function(e) {
                self.setItemsLayout(&#x27;pundit-view-tile&#x27;);
            }
        };
        
        dojo.behavior.add(beh);
        
        &#x2F;&#x2F;Stop mouse wheel event propagation
&#x2F;&#x2F;        dojo.connect(dojo.byId(&#x27;pundit-tab-content&#x27; + self.name), (!dojo.isMozilla ? &quot;onmousewheel&quot; : &quot;DOMMouseScroll&quot;),function(e){
&#x2F;&#x2F;            dojo.byId(&#x27;pundit-tab-content&#x27; + self.name).scrollTop -= e. wheelDeltaY;
&#x2F;&#x2F;            dojo.stopEvent(e);
&#x2F;&#x2F;        });
        
        
                
    }, &#x2F;&#x2F; initBehaviors()
    
   
    
    initContextualMenu: function() {
        var self = this;
        &#x2F;&#x2F;TODO Do we need to init any men
    },
    
    &#x2F;&#x2F; create the DOM representation for the given item
    &#x2F;&#x2F; item is a an object formatted for itemDnD
    itemNodeCreator: function (item, hint) {
        var self = this,
            rdftype = &quot;&quot;,
            label = item.label,
            i,
            node;
        
        &#x2F;&#x2F; Tree item
        if (typeof(item.type) === &#x27;undefined&#x27;) {
            item = {};
            var i = _PUNDIT.vocab.draggedItem;
            item.value = i.value;
            item.type= i.type;
            item.rdfData= i.rdfData;
            item.rdftype = i.rdftype;
            item.label = i.label;
            if (typeof(i.image) !== &#x27;undefined&#x27;)
                item.image = i.image;
        }
                
        &#x2F;&#x2F; Show only the first 3 rdftypes?

        for (i=0;i&lt;3;i++) {
            if (typeof(item.rdftype[i]) !== &#x27;undefined&#x27;){
                if (rdftype !== &quot;&quot;)
                    rdftype += &#x27;, &#x27;;                    
                var index = item.rdftype[i].lastIndexOf(&#x27;#&#x27;);
                if (index !== -1){
                    rdftype += item.rdftype[i].substring(index +1);
                } else {
                    rdftype += item.rdftype[i].substring(item.rdftype[0].lastIndexOf(&#x27;&#x2F;&#x27;) + 1)
                }
            } else
                break;
        }
        
        &#x2F;&#x2F; TODO: this check is wrong, what if an item comes with no rdftype but
        &#x2F;&#x2F; it&#x27;s a proper item? It gets shown as literal ...
        if (item.rdftype.length === 0)
            rdftype = &#x27;Literal&#x27;;
        else {
            if (item.rdftype[0] === ns.fragments.text)
                label = item.label;
            
            if (item.rdftype.length &gt; 3)
                rdftype += &#x27;, ...&#x27;;
        }        
        
        if (hint !== &quot;avatar&quot;) {
            node = document.createElement(&#x27;li&#x27;);
            dojo.addClass(node, &#x27;pundit-&#x27; + item.type);
            dojo.addClass(node, &#x27;pundit-shown&#x27;);
            node.innerHTML = &#x27;&lt;span class=&quot;pundit-icon-context-button&quot;&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;pundit-trim pundit-item-label&quot;&gt;&#x27; +label + &#x27;&lt;&#x2F;span&gt;&lt;span class=&quot;pundit-item-add-button&quot;&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;pundit-item-remove-button&quot;&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;pundit-trim pundit-item-rdftype&quot; &gt;&amp;nbsp;(&#x27; + rdftype + &#x27;)&lt;&#x2F;span&gt;&#x27;;
        } else {
            node = document.createElement(&#x27;div&#x27;);
            node.innerHTML = item.label;
        }
        
        return {
            node: node, 
            data: item, 
            type: item.type
        };

    }, &#x2F;&#x2F; itemNodeCreator()
    
    addItemsFromSelector: function(items) {
        var self = this;
        self.log(&quot;Received items from a selector.&quot;);
        &#x2F;&#x2F;for (var i in items)
        for (var i = items.length; i--;)
            if (!self.uriInItems(i)) {
                self.addItem({
                    type: [&#x27;subject&#x27;,&#x27;object&#x27;],
                    rdftype: items[i].type,
                    value: i,
                    label: items[i].label,
                    comment: items[i].comment,
                    depiction: items[i].depiction
                });
            }
            
    }, &#x2F;&#x2F; addItemsFromSelector()
    
    &#x2F;**
    * @method uriInItems
    * @description Check if an item is present in the itemsDnD container
    * @param uri {string} The Uri of the item to be searched
    * @return {boolean} True if exists, false otherwise
    *&#x2F;
    uriInItems: function(uri) {
        var self = this,
            ret = false;
        
        self.itemsDnD.forInItems(function(item){
            if (item.data.value == uri)
                ret = true;
        });
        return ret;
    },

	setItemsLayout: function(name) {
	    var self = this,
	        layouts = [&#x27;pundit-view-list&#x27;, &#x27;pundit-view-tile&#x27;];
	    dojo.query(&#x27;#pundit-&#x27;+self.name+&#x27;-container .pundit-sort-items&#x27;).removeClass(&#x27;pundit-selected&#x27;);
	    dojo.query(&#x27;#pundit-&#x27;+self.name+&#x27;-container .pundit-sort-items.&#x27;+name).addClass(&#x27;pundit-selected&#x27;);
	    &#x2F;&#x2F;for (var i in layouts) 
        for (var i = layouts.length; i--;) 
	        dojo.query(&#x27;#pundit-&#x27;+self.name).removeClass(layouts[i]);
	    dojo.query(&#x27;#pundit-&#x27;+self.name).addClass(name);
	},

    getSelectedTab: function() {
        var self=this;
        return dojo.attr(dojo.query(&#x27;#pundit-&#x27;+self.name+&#x27;-filter-list li.pundit-selected&#x27;)[0], &#x27;id&#x27;);
    },

    
    &#x2F;&#x2F; showSuggestionsTab: function(n) {
    &#x2F;&#x2F;     var self = this;
    &#x2F;&#x2F; 
    &#x2F;&#x2F;     dojo.query(&#x27;#filter&#x27;+self.name+&#x27;Suggestions .suggestionNumber&#x27;).html(n);
    &#x2F;&#x2F;     dojo.query(&#x27;#pundit-&#x27;+self.name+&#x27;-container .pundit-item-filter-list li&#x27;).removeClass(&#x27;pundit-selected&#x27;);
    &#x2F;&#x2F;     dojo.query(&#x27;#filter&#x27;+self.name+&#x27;Suggestions&#x27;).removeClass(&#x27;pundit-hidden&#x27;);
    &#x2F;&#x2F;     dojo.query(&#x27;#filter&#x27;+self.name+&#x27;Suggestions&#x27;).addClass(&#x27;pundit-selected&#x27;);
    &#x2F;&#x2F;     
    &#x2F;&#x2F; },
    
    
    hideSuggestionsTab: function() {
        dojo.query(&#x27;#pundit-tab-filter&#x27;+self.name+&#x27;Suggestions&#x27;).addClass(&#x27;pundit-hidden&#x27;);
    },

    showOnlyItems: function(nodes) {
        var self=this;
        &#x2F;&#x2F; Reset highlight on pundit containers and semlib filters items
        dojo.query(&#x27;.pundit-tc-dnd-container ul&#x27;).removeClass(&#x27;dnd_selected&#x27;);
        dojo.query(&#x27;#pundit-&#x27;+self.name+&#x27;-container .pundit-item-filter-list li&#x27;).removeClass(&#x27;pundit-selected&#x27;);
        this.hideAllItems();

        if (nodes.length === 0) 
            return;
        
        var self = this,
            all = self.getItemsIds(dojo.query(&#x27;#pundit-&#x27;+self.name+&#x27; li&#x27;)),
            nodes_ids = self.getItemsIds(nodes);
        
        for (var id in all) &#x2F;&#x2F;ok all is an object
            if (typeof(nodes_ids[id]) !== &#x27;undefined&#x27;) {
                dojo.query(&#x27;#&#x27;+id).removeClass(&#x27;pundit-hidden&#x27;);
                setTimeout((function(i) {
                    return function() {
                        dojo.query(&#x27;#&#x27;+i).addClass(&#x27;pundit-shown&#x27;);
                    }
                })(id), 10);
            }
        
    }, &#x2F;&#x2F; showOnlyItems()
    
    showAllItems: function() {
        var self = this;
        &#x2F;&#x2F; Reset highlight on pundit containers
        dojo.query(&#x27;.pundit-tc-dnd-container ul&#x27;).removeClass(&#x27;dnd_selected&#x27;);
        dojo.query(&#x27;#pundit-&#x27;+self.name+&#x27;-container .pundit-item-filter-list li&#x27;).removeClass(&#x27;pundit-selected&#x27;);
        dojo.query(&#x27;#pundit-tab-filter&#x27;+self.name+&#x27;All&#x27;).addClass(&#x27;pundit-selected&#x27;);

        dojo.query(&#x27;#pundit-&#x27;+self.name+&#x27; li&#x27;).removeClass(&#x27;pundit-hidden&#x27;);
        setTimeout(function() {
            &#x2F;&#x2F;TODO WHY this is not parametric? 
            dojo.query(&#x27;#semlibItems li&#x27;).addClass(&#x27;pundit-shown&#x27;);
        }, 10);
    },

    hideAllItems: function() {
        var self= this;
        dojo.query(&#x27;#pundit-&#x27;+self.name+&#x27; li&#x27;).removeClass(&#x27;pundit-shown&#x27;);
        dojo.query(&#x27;#pundit-&#x27;+self.name+&#x27; li&#x27;).addClass(&#x27;pundit-hidden&#x27;);
    },
    
    refreshItemsNumber: function() {
        var self=this,
            ret = 0;
        this.itemsDnD.forInItems(function(item){
            if (item.data.type[0] !== &#x27;predicate&#x27;)
                ret++;
        });
        dojo.query(&#x27;#pundit-&#x27;+self.name+&#x27;-number&#x27;).html(ret);
    },
    
    &#x2F;&#x2F; Returns an array of nodes
    getNodesEntities: function() {
        var self = this,
            foo = [];
        for (var id in self.itemsDnD.map) {
            if (dojo.indexOf(self.itemsDnD.map[id].data.rdftype, ns.fragments.text) === -1 
                &amp;&amp; dojo.indexOf(self.itemsDnD.map[id].data.rdftype, ns.image) === -1 
                &amp;&amp; dojo.indexOf(self.itemsDnD.map[id].data.rdftype, ns.fragments.image) === -1
                &amp;&amp; dojo.indexOf(self.itemsDnD.map[id].data.rdftype, ns.rdf_property) === -1
                &amp;&amp; dojo.indexOf(self.itemsDnD.map[id].data.rdftype, ns.page) === -1)
                    foo.push(dojo.query(&#x27;#&#x27;+id)[0]);
        }
        return foo;
    },

    getItemsWhereFieldTest: function(field, testFunction) {
        var self = this,
            foo = [];
        for (var id in self.itemsDnD.map) {
            var value = self.itemsDnD.map[id].data[field];
            if (testFunction(value) === true)
                foo.push(self.itemsDnD.map[id].data);
            else self.log(&quot;Item &quot; + self.itemsDnD.map[id].data.value + &quot; discarded, missing field &quot; + field);    
        }
        return foo;
    },
    
    getNodesWhereField: function(field, value) {
        var self = this,
            foo = [];
        for (var id in self.itemsDnD.map) 
            if (self.itemsDnD.map[id].data[field] === value)
                foo.push(dojo.query(&#x27;#&#x27;+id)[0]);
        return foo;
    },
    
    getNodesWhereTypeIs: function(type) {
        var self = this,
            foo = [];
        for (var id in self.itemsDnD.map) 
            if (dojo.indexOf(self.itemsDnD.map[id].data.rdftype, type) !== -1)
                foo.push(dojo.query(&#x27;#&#x27;+id)[0]);
        return foo;
    },
    
    getLiterals:function(){
        var self = this,
            foo = [];
        for (var id in self.itemsDnD.map){
            var item = self.itemsDnD.map[id];
            if (item.data.type.length === 1 &amp;&amp; item.data.rdftype.length === 0)
                if (dojo.indexOf(item.data.type, &#x27;object&#x27;) !== -1)
                    foo.push(dojo.query(&#x27;#&#x27;+id)[0]);
        }
        return foo;   
    },
    
    getItemsIds: function(nodes) {
        var ids = {};
        nodes.forEach(function(pi){
            ids[dojo.attr(pi, &#x27;id&#x27;)] = true;
        });
        return ids;
    },
    
    getItemFromUri: function(uri) {
        var self = this,
            ret;
            
        self.itemsDnD.forInItems(function(item){
            if (item.data.value === uri)
                ret = item.data;
        });
        return ret;
    },
    
    getItemsFromParentItem: function(parentUri) {
        var self = this,
            ret = [];
            
        self.itemsDnD.forInItems(function(item){
            if (item.data.isPartOf === parentUri)
                ret.push(item.data);
        });
        return ret;
    },

    getItemIdFromUri: function(uri) {
        var self = this;
        
        for (var id in self.itemsDnD.map) {
            if (self.itemsDnD.map[id].data.value === uri)
                return id;
        }
        self.log(&#x27;ERROR: getItemIdFromUri with wrong uri? &#x27;+uri);
        return null;
    },
    
    getItemsFromTerm:function(term, rdftypes, rejectedTypes){
        var self = this,
            items = self.getItemsWhereFieldTest(&#x27;description&#x27;, function(c) {    
                &#x2F;&#x2F; No content? no match
                if (typeof(c) === &#x27;undefined&#x27;) return false;

                &#x2F;&#x2F;Should i consider also range and domain parameters to reuse 
                &#x2F;&#x2F;this also inside pundit when suggesting items? Or this has 
                &#x2F;&#x2F;to be performed on a later step?

                &#x2F;&#x2F; For each word selected, if it&#x27;s not present in item
                &#x2F;&#x2F; content, its not ok: return false
                for (var i = term.length; i--;) 
                    if (c.indexOf(term[i]) === -1) return false;

                return true;
            });
        if (((typeof rdftypes === &#x27;undefined&#x27;) &amp;&amp; (typeof rejectedTypes === &#x27;undefined&#x27;)))
            return items
        else {
            return self.filterItemsByRdftype(items, rdftypes, rejectedTypes);
        }
    },
    &#x2F;&#x2F;TODO Should we move this to an helper and not to semlibItems
    &#x2F;&#x2F;Filter items array according to an array of rdftypes
    filterItemsByRdftype:function(items, rdftypes, rejectedTypes){
        var filteredItems = [];
        if (typeof rdftypes === &#x27;undefined&#x27;) rdftypes = [];
        if (typeof rejectedTypes === &#x27;undefined&#x27;) rejectedTypes = [];
        &#x2F;&#x2F;for (var i in items){
        for (var i = items.length; i--;){
            var accept = true;
            &#x2F;&#x2F;for (var j in items[i].rdftype){
            for (var j = items[i].rdftype.length; j--;){
                &#x2F;&#x2F;for (var k in rdftypes){
                for (var k = rdftypes.length; k--;){
                    if (items[i].rdftype[j] === rdftypes[k]){
                        accept = true;
                        break;
                    }else{
                        accept = false;
                    }
                }
                &#x2F;&#x2F;for (var k in rejectedTypes){
                for (var k = rejectedTypes.length; k--;){
                    if (items[i].rdftype[j] === rejectedTypes[k]){
                        accept = false;
                        break;
                    }else{
                        accept = true;
                    }
                }
                if (accept === true)
                    break;
            }
            if (accept === true)
                filteredItems.push(items[i]);
        }
        return filteredItems;
    },
    &#x2F;&#x2F;return array or property items filtered by ranges and domain
    getProperties:function(ranges, domains){
        var props = [];
        &#x2F;&#x2F;Get all properties
        this.itemsDnD.forInItems(function(item){
            var t = item.data.rdftype;
            &#x2F;&#x2F;for (var i in t){
            for (var i = t.length; i--;){
                if (t[i] === ns.rdf_property){
                    props.push(item.data);
                    break;
                }
            }
        });
        if ((typeof ranges === &#x27;undefined&#x27;) || (typeof domains === &#x27;undefined&#x27;))
            return props;
        else{
            &#x2F;&#x2F;FIlter props
            var filteredProps = [];
            &#x2F;&#x2F;for (var i in props){
            for (var i = props.length; i--;){
                var domainsIntersection = tripleComposer._intersection([props[i].domain, domains]);
                var rangesIntersection = tripleComposer._intersection([props[i].range, ranges]);
                if ((typeof domains === &#x27;undefined&#x27;) || props[i].domain.length === 0 || domains.length === 0 || domainsIntersection.length &gt; 0){
                    if ((typeof ranges === &#x27;undefined&#x27;)|| props[i].range.length === 0 || ranges.length === 0 || rangesIntersection.length &gt; 0){
                        filteredProps.push(props[i]);
                    }
                }
            }
            return filteredProps;
        }
    },

    setItemFieldFromUri: function(uri, field, value) {
        var self = this,
            id = self.getItemIdFromUri(uri),
            item = self.itemsDnD.map[id];

        &#x2F;&#x2F; Set the field and overwrite the item in the container
        item.data[field] = value;
        self.itemsDnD.setItem(id, item);
        self.itemsDnD.sync();

        return true;
    },
    
    &#x2F;**
    * @method addItem
    * @description Add an item to the itemsDnD if it&#x27;s not already in it.
    * @param item {object} A json object containing the item information.
    *&#x2F;
    addItem: function(item) {
        var self = this;

        if (self.uriInItems(item.value)) {
            self.log(&quot;Not adding again &quot;+item.value.substr(0,30)+&#x27;..&#x27;)
            return;
        }

        self.itemsDnD.insertNodes(false, [item]);
        dojo.behavior.apply();
        self.refreshItemsNumber();

        self.fireOnItemAdded(item);
        &#x2F;&#x2F;DEBUG Improve this?
        &#x2F;&#x2F;Check if is an expointer?
        
        self.log(&quot;Added to pundit items: &quot; + item.value);
    }, &#x2F;&#x2F; addItem()
    
    &#x2F;**
    * @method removeItemFromUri
    * @description Remove an item from the itemsDnD if it&#x27;s in it given its Uri.
    * @param uri {string} The Uri of the item to be removed
    *&#x2F;
    removeItemFromUri: function(uri) {
        var self = this;
        if (!self.uriInItems(uri))
            return;
            
        var itemId = self.getItemIdFromUri(uri),
            item = self.getItemFromUri(uri);
        
        self.itemsDnD.delItem(itemId);
        dojo.destroy(itemId);
        self.itemsDnD.sync();
        self.refreshItemsNumber();
        
        self.fireOnItemRemoved(item);
        self.log(&quot;Removed item from pundit items: &quot; + uri);
        
        return false;
    },
 
    &#x2F;**
    * @method removeAllItems
    * @description Removes all items from the itemsDnD.
    *&#x2F;   
    removeAllItems: function() {
        var self = this;
  		var toRemove = [];
        self.itemsDnD.forInItems(function(item){
			var itemId = self.getItemIdFromUri(item.data.value);
			toRemove.push(itemId);
	        
        });
		
		&#x2F;&#x2F;for (var itemToRemove in toRemove) {
        for (var itemToRemove = toRemove.length; itemToRemove--;) {
			self.itemsDnD.delItem(toRemove[itemToRemove]);
	        dojo.destroy(toRemove[itemToRemove]);	
			self.itemsDnD.sync();	
		}
	
        self.refreshItemsNumber();
        self.fireOnAllItemsRemoved();
        self.log(&quot;Removed all item from pundit items&quot;);
		
		return false;
        
    },

    &#x2F;&#x2F; BUCKET CREATION
    &#x2F;&#x2F; TODO: move this into its own package.. or find a smarter&#x2F;faster way
    &#x2F;&#x2F; to add predicates. Make it configurable or something ..
    createBucketForPredicate: function(d) {
        var self = this,
            b = new pundit.TriplesBucket();
            
        b.addTriple(d.value, ns.items.label, d.label, &#x27;literal&#x27;);
        b.addTriple(d.value, ns.items.altLabel, d.label, &#x27;literal&#x27;);
        b.addTriple(d.value, ns.items.description, d.description, &#x27;literal&#x27;);
        
        b.addTriple(d.value, ns.items.type, ns.rdf_property, &#x27;uri&#x27;);
        b.addTriple(ns.rdf_property, ns.items.label, &#x27;RDF Property&#x27;, &#x27;literal&#x27;);

        return b;
    },
    
    createBucketForVocabItem: function(d) {
        var self = this,
            b = new pundit.TriplesBucket();
            
        b.addTriple(d.value, ns.items.label, d.label, &#x27;literal&#x27;);
        b.addTriple(d.value, ns.items.altLabel, d.label, &#x27;literal&#x27;);
        b.addTriple(d.value, ns.items.description, d.description, &#x27;literal&#x27;);
        b.addTriple(d.value, ns.items.image, d.image, &#x27;literal&#x27;);

        &#x2F;&#x2F; DEBUG: no rdftype? Raise some kind of error&#x2F;warning&#x2F;log?
        &#x2F;&#x2F; TODO: add sanity checks on other similar .rdftype uses?
        if (typeof(d.rdftype) !== &quot;undefined&quot;)
            for (var i = d.rdftype.length; i--;) {
                b.addTriple(d.value, ns.items.type, d.rdftype[i], &#x27;uri&#x27;);
                b.addTriple(d.rdftype[i], ns.items.label, ns.getLabelFromUri(d.rdftype[i]), &#x27;literal&#x27;);
            }
        return b;
    },
    
    createBucketForTextFragment: function(d) {
        var self = this,
        b = new pundit.TriplesBucket();
            
        b.addTriple(d.value, ns.items.label, d.label, &#x27;literal&#x27;);
        b.addTriple(d.value, ns.items.altLabel, d.label, &#x27;literal&#x27;);
        b.addTriple(d.value, ns.items.description, d.description, &#x27;literal&#x27;);
        b.addTriple(d.value, ns.items.image, d.image, &#x27;uri&#x27;);

        b.addTriple(d.value, ns.items.pageContext, d.pageContext, &#x27;uri&#x27;);
        b.addTriple(d.value, ns.items.isPartOf, d.isPartOf, &#x27;uri&#x27;);
        
        b.addTriple(d.value, ns.items.type, ns.fragments.text, &#x27;uri&#x27;);
        b.addTriple(ns.fragments.text, ns.items.label, &#x27;Page fragment&#x27;, &#x27;literal&#x27;);

        return b;
    },
    
    createBucketForImageFragment: function(d) {
        var self = this,
            b = new pundit.TriplesBucket();
            
        b.addTriple(d.value, ns.items.label, d.label, &#x27;literal&#x27;);
        b.addTriple(d.value, ns.items.altLabel, d.label, &#x27;literal&#x27;);
        b.addTriple(d.value, ns.items.description, d.description, &#x27;literal&#x27;);
        b.addTriple(d.value, ns.items.image, d.image, &#x27;uri&#x27;);

        b.addTriple(d.value, ns.items.pageContext, d.pageContext, &#x27;uri&#x27;);
        b.addTriple(d.value, ns.items.isPartOf, d.isPartOf, &#x27;uri&#x27;);
        
        b.addTriple(d.value, ns.items.type, ns.image, &#x27;uri&#x27;);
        b.addTriple(ns.image, ns.items.label, &#x27;Image&#x27;, &#x27;literal&#x27;);

        return b;
    },
    
    createBucketForImageRegionFragment: function(d) {
        var self = this,
            b = new pundit.TriplesBucket();
            
        b.addTriple(d.value, ns.items.label, d.label, &#x27;literal&#x27;);
        b.addTriple(d.value, ns.items.altLabel, d.label, &#x27;literal&#x27;);
        b.addTriple(d.value, ns.items.description, d.description, &#x27;literal&#x27;);
        b.addTriple(d.value, ns.items.image, d.image, &#x27;uri&#x27;);
        b.addTriple(d.value, ns.items.parentItemXP, d.parentItemXP, &#x27;uri&#x27;);

        b.addTriple(d.value, ns.items.pageContext, d.pageContext, &#x27;uri&#x27;);
        b.addTriple(d.value, ns.items.isPartOf, d.isPartOf, &#x27;uri&#x27;);
        
        b.addTriple(d.value, ns.items.type, ns.fragments.image, &#x27;uri&#x27;);
        b.addTriple(ns.fragments.image, ns.items.label, &#x27;Image Fragment&#x27;, &#x27;literal&#x27;);
        
        b.addTriple(d.value, ns.items.selector, d.selector, &#x27;uri&#x27;);
        
        
        &#x2F;&#x2F;Add triples for the selectors
        &#x2F;&#x2F;for (var i in d.selectors){
        for (var i = d.selectors.length; i--;){    
            var selectorUri = ns.selectorBaseUri + d.selectors[i].type + &#x27;&#x2F;&#x27; + self.crypto.hex_md5(d.image + dojo.toJson(d.selectors[i]));
            
            b.addTriple(d.value, ns.items.selector, selectorUri, &#x27;uri&#x27;);
            b.addTriple(selectorUri, ns.items.type, ns.selectors[d.selectors[i].type].value, &#x27;uri&#x27;);
            b.addTriple(ns.selectors[d.selectors[i].type].value, ns.items.label, ns.selectors[d.selectors[i].type].label, &#x27;literal&#x27;);
            b.addTriple(ns.selectors[d.selectors[i].type].value, ns.items.description, ns.selectors[d.selectors[i].type].description, &#x27;literal&#x27;);
            
            b.addTriple(selectorUri, ns.rdf_value, dojo.toJson(d.selectors[i]), &#x27;literal&#x27;);
        }
        
        return b;
    },

    createBucketForItem: function(d) {
        var self = this,
            b = new pundit.TriplesBucket();
            
        b.addTriple(d.value, ns.items.label, d.label, &#x27;literal&#x27;);
        b.addTriple(d.value, ns.items.altLabel, d.altLabel, &#x27;literal&#x27;);
        b.addTriple(d.value, ns.items.description, d.description, &#x27;literal&#x27;);
        b.addTriple(d.value, ns.items.image, d.image, &#x27;literal&#x27;);

        &#x2F;&#x2F;for (var i in d.rdftype) {
        for (var i = d.rdftype.length; i--;) {
            b.addTriple(d.value, ns.items.type, d.rdftype[i], &#x27;uri&#x27;);
            b.addTriple(d.rdftype[i], ns.items.label, ns.getLabelFromUri(d.rdftype[i]), &#x27;literal&#x27;);
        }

        b.addTriple(d.value, ns.items.prefLabel, d.label, &#x27;literal&#x27;);

        return b;
    },
    
    createBucketForPage: function(d) {
        var self = this,
            b = new pundit.TriplesBucket();
            
        b.addTriple(d.value, ns.items.label, d.label, &#x27;literal&#x27;);
        b.addTriple(d.value, ns.items.altLabel, d.altLabel, &#x27;literal&#x27;);
        b.addTriple(d.value, ns.items.description, d.description, &#x27;literal&#x27;);
        &#x2F;&#x2F;b.addTriple(d.value, ns.items.image, d.image, &#x27;literal&#x27;);

        &#x2F;&#x2F;for (var i in d.rdftype) {
        for (var i = d.rdftype.length; i--;) {
            b.addTriple(d.value, ns.items.type, d.rdftype[i], &#x27;uri&#x27;);
            b.addTriple(d.rdftype[i], ns.items.label, ns.getLabelFromUri(d.rdftype[i]), &#x27;literal&#x27;);
        }

        b.addTriple(d.value, ns.items.prefLabel, d.label, &#x27;literal&#x27;);
        return b;
    },
    
    refreshItems:function(){
        var self = this,
            t = self.getSelectedTab();
        self[&#x27;show_&#x27;+t.replace(&#x2F;-&#x2F;g, &#x27;&#x27;)]();
    }

});
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
