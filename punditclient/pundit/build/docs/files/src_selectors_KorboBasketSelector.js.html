<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>src&#x2F;selectors&#x2F;KorboBasketSelector.js - Pundit</title>
	<link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.8.0pr2&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
	<link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
	<link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
	<link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
	<script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.8.0pr2&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

	<div id="doc">
		<div id="hd" class="yui3-g header">
			<div class="yui3-u-3-4">

				<h1><img src="http:&#x2F;&#x2F;thepund.it&#x2F;assets&#x2F;img&#x2F;pundit_500.png" title="Pundit"></h1>

			</div>
			<div class="yui3-u-1-4 version">
				<em>API Docs for: PUNDIT Project 0.12-Pumpkin</em>
			</div>
		</div>
		<div id="bd" class="yui3-g">

			<div class="yui3-u-1-4">
				<div id="docs-sidebar" class="sidebar apidocs">
					<div id="api-list">
						<h2 class="off-left">APIs</h2>

						<div id="api-tabview" class="tabview">
							<ul class="tabs">
								<li><a href="#api-classes">Classes</a></li>
								<li><a href="#api-modules">Modules</a></li>
							</ul>

							<div id="api-tabview-filter">
								<input type="search" id="api-filter" placeholder="Type to filter APIs">
							</div>

							<div id="api-tabview-panel">
								<ul id="api-classes" class="apis classes">

									<li><a href="..&#x2F;classes/pundit.annotators.AnnotatorsBase.html">pundit.annotators.AnnotatorsBase</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.annotators.AnnotatorsConductor.html">pundit.annotators.AnnotatorsConductor</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.annotators.FakeAnnotator.html">pundit.annotators.FakeAnnotator</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.annotators.TextFragmentAnnotator.html">pundit.annotators.TextFragmentAnnotator</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.authenticatedRequests.html">pundit.authenticatedRequests</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.baseComponent.html">pundit.baseComponent</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.BasePanel.html">pundit.BasePanel</a></li>

									<li><a href="..&#x2F;classes/pundit.CommentTag.html">pundit.CommentTag</a></li>

									<li><a href="..&#x2F;classes/pundit.CommentTagPanel.html">pundit.CommentTagPanel</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.Configuration.html">pundit.Configuration</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.contextualMenu.html">pundit.contextualMenu</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.DataTxt.html">pundit.DataTxt</a></li>

									<li>
										<a href="..&#x2F;classes/pundit.DbpediaSpotlight.html">pundit.DbpediaSpotlight</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.FastTextHandler.html">pundit.FastTextHandler</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.ImageAnnotationPanel.html">pundit.ImageAnnotationPanel</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.Init.html">pundit.Init</a></li>

									<li><a href="..&#x2F;classes/pundit.ItemContainerManager.html">pundit.ItemContainerManager</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.KorboBasketSelector.html">pundit.KorboBasketSelector</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.myPundit.html">pundit.myPundit</a></li>

									<li><a href="..&#x2F;classes/pundit.NotebookManager.html">pundit.NotebookManager</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.PageHandler.html">pundit.PageHandler</a></li>

									<li><a href="..&#x2F;classes/pundit.Previewer.html">pundit.Previewer</a></li>

									<li><a href="..&#x2F;classes/pundit.RecognizerPanel.html">pundit.RecognizerPanel</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.ResourcesPanel.html">pundit.ResourcesPanel</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.selectors.BibServerSelector.html">pundit.selectors.BibServerSelector</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.selectors.DBPediaSelector.html">pundit.selectors.DBPediaSelector</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.selectors.EuropeanaSelector.html">pundit.selectors.EuropeanaSelector</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.selectors.FreebaseSelector.html">pundit.selectors.FreebaseSelector</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.selectors.SelectorBase.html">pundit.selectors.SelectorBase</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.selectors.VocabSelector.html">pundit.selectors.VocabSelector</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.selectors.WordnetSelector.html">pundit.selectors.WordnetSelector</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.TripleComposer.html">pundit.TripleComposer</a>
									</li>

									<li><a href="..&#x2F;classes/pundit.XpointersHelper.html">pundit.XpointersHelper</a>
									</li>

								</ul>

								<ul id="api-modules" class="apis modules">

									<li><a href="..&#x2F;modules/pundit.html">pundit</a></li>

								</ul>
							</div>
						</div>
					</div>

				</div>
			</div>
			<div class="yui3-u-3-4">
				<div id="api-options">
					Show:
					<label for="api-show-inherited">
						<input type="checkbox" id="api-show-inherited" checked>
						Inherited
					</label>

					<label for="api-show-protected">
						<input type="checkbox" id="api-show-protected">
						Protected
					</label>

					<label for="api-show-private">
						<input type="checkbox" id="api-show-private">
						Private
					</label>
					<label for="api-show-deprecated">
						<input type="checkbox" id="api-show-deprecated">
						Deprecated
					</label>

				</div>

				<div class="apidocs">
					<div id="docs-main">
						<div class="content">
							<h1 class="file-heading">File: src&#x2F;selectors&#x2F;KorboBasketSelector.js</h1>

							<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;**
  * @class pundit.KorboBasketSelector
  * @extends pundit.Selector
  * @description Selects items from a Korbo basket
  *&#x2F;
dojo.provide(&quot;pundit.selectors.KorboBasketSelector&quot;);
dojo.declare(&quot;pundit.selectors.KorboBasketSelector&quot;, pundit.selectors.SelectorBase, {

    opts: {
        &#x2F;&#x2F; Number of items to display in the suggestion list
        limit: 30,

        &#x2F;&#x2F; Ms to wait after a keystroke before querying the service
        keyInputTimerLength: 500,

        &#x2F;&#x2F; Minimum number of characters to trigger a query to the server 
        keywordMinimumLength: 3,
        
        &#x2F;&#x2F; korboBasketReconURL: &#x27;http:&#x2F;&#x2F;korbo.local&#x2F;api.php&#x2F;basket&#x2F;reconcile&#x2F;&#x27;,
        korboBasketReconURL: &#x27;http:&#x2F;&#x2F;korbo.netseven.it&#x2F;api.php&#x2F;basket&#x2F;reconcile&#x2F;&#x27;,
        korboItemsBaseURL: &#x27;http:&#x2F;&#x2F;purl.org&#x2F;net7&#x2F;korbo&#x27;,
        korboSchemaBaseURL: &#x27;http:&#x2F;&#x2F;purl.org&#x2F;net7&#x2F;korbo&#x2F;type&#x2F;&#x27;,
        
        baskets: [16],
        
        layouts: [&#x27;pundit-view-list&#x27;, &#x27;pundit-view-tile&#x27;]
    },

    constructor: function(options) {
        var self = this;
        self.requests = {};
        self.log(&#x27;Selector &#x27;+self.name+&#x27; up and running.&#x27;);
    }, &#x2F;&#x2F; constructor()
    
    &#x2F;&#x2F; (async) Return a list of items for the given term, calling the callback func
    getItemsForTerm: function(term, func) {
        var self = this;
        
        &#x2F;&#x2F; TODO: cache the results? 
        self.requests[term] = {f: func, items: [], done: 0};
        self.requests[term].jobId = _PUNDIT.loadingBox.addJob(&#x27;Korbo query: &#x27;+term);
        self.setLoading(true);

        dojo.io.script.get({
            callbackParamName: &quot;jsonp&quot;,
            url: self.opts.korboBasketReconURL + self.opts.baskets[0],
            content: {
                query: dojo.toJson({query: term})
            },
            load: function(r) {
                    
                &#x2F;&#x2F; DEBUG: do we need sanity checks here? Think it&#x27;s quite safe
                &#x2F;&#x2F; to just use _getItemsFromKorboResults() and make it return
                &#x2F;&#x2F; an empty array .. 
                &#x2F;&#x2F; if (r.result.length === 0) {
                &#x2F;&#x2F;     func([]);
                &#x2F;&#x2F; } else 

                func(self._getItemsFromKorboResults(r.result, term));

                _PUNDIT.loadingBox.setJobOk(self.requests[term].jobId);
                self.setLoading(false);
            },
            error: function(response, ioArgs) {
                self.log(self.name+&#x27; getItemsForTerm got an error :(&#x27;);
                console.log(&#x27;ACF  ERRORz&#x27;, response, ioArgs);
                &#x2F;&#x2F; TODO: what to do with passed function??
                func([]);
                _PUNDIT.loadingBox.setJobKo(req.jobId);
                self.setLoading(false);
            }
        });
        
    }, &#x2F;&#x2F; getItemsForTerm()
    
    _getItemsFromKorboResults: function(r, term) {
        var self = this,
            len = r.length,
            result = [];
        
        for (var i=0; i&lt;len; i++) {
            var rdf_types = [],
                current = r[i],
                item;

            for (var j = current.type.length; j--;)
                rdf_types.push(self.opts.korboSchemaBaseURL + current.type[j]);
                    
            item = {
                type: [&#x27;subject&#x27;],
                rdftype: rdf_types,
                label: current.name, 
                value: self.opts.korboItemsBaseURL + current.id,
                description: &#x27;TODO: &#x27; + current.name+ &#x27;, url: &#x27;+self.opts.korboItemsBaseURL + current.id,
                altLabel: current.name
            };

            item.rdfData = semlibItems.createBucketForItem(item).bucket;
            self.requests[term].items.push(item);
                    
            result.push(item);
                
        } &#x2F;&#x2F; for i
            
        self.requests[term].done = len;
        return result;
    } &#x2F;&#x2F; _getItemsFromFreebaseResults()
    
});
    </pre>
							</div>

						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
	<script>prettyPrint();</script>
	<script src="..&#x2F;assets/js/yui-prettify.js"></script>
	<script src="..&#x2F;assets/../api.js"></script>
	<script src="..&#x2F;assets/js/api-filter.js"></script>
	<script src="..&#x2F;assets/js/api-list.js"></script>
	<script src="..&#x2F;assets/js/api-search.js"></script>
	<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
